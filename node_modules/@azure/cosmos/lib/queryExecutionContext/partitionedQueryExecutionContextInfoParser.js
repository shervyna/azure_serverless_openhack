"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const assert_1 = tslib_1.__importDefault(require("assert"));
const util = tslib_1.__importStar(require("util"));
/** @hidden */
const PartitionedQueryContants = {
    QueryInfoPath: "queryInfo",
    TopPath: ["queryInfo", "top"],
    OrderByPath: ["queryInfo", "orderBy"],
    AggregatePath: ["queryInfo", "aggregates"],
    QueryRangesPath: "queryRanges",
    RewrittenQueryPath: ["queryInfo", "rewrittenQuery"]
};
// TODO: any partitionedQueryExecutionInfo
/** @hidden */
class PartitionedQueryExecutionContextInfoParser {
    static parseRewrittenQuery(partitionedQueryExecutionInfo) {
        return this._extract(partitionedQueryExecutionInfo, PartitionedQueryContants.RewrittenQueryPath);
    }
    static parseQueryRanges(partitionedQueryExecutionInfo) {
        return this._extract(partitionedQueryExecutionInfo, PartitionedQueryContants.QueryRangesPath);
    }
    static parseOrderBy(partitionedQueryExecutionInfo) {
        return this._extract(partitionedQueryExecutionInfo, PartitionedQueryContants.OrderByPath);
    }
    static parseAggregates(partitionedQueryExecutionInfo) {
        return this._extract(partitionedQueryExecutionInfo, PartitionedQueryContants.AggregatePath);
    }
    static parseTop(partitionedQueryExecutionInfo) {
        return this._extract(partitionedQueryExecutionInfo, PartitionedQueryContants.TopPath);
    }
    static _extract(partitionedQueryExecutionInfo, path) {
        let item = partitionedQueryExecutionInfo;
        if (typeof path === "string") {
            return item[path];
        }
        assert_1.default.ok(Array.isArray(path), util.format("%s is expected to be an array", JSON.stringify(path)));
        for (const p of path) {
            item = item[p];
            if (item === undefined) {
                return;
            }
        }
        return item;
    }
}
exports.PartitionedQueryExecutionContextInfoParser = PartitionedQueryExecutionContextInfoParser;
//# sourceMappingURL=partitionedQueryExecutionContextInfoParser.js.map